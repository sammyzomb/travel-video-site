<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>æ‰€æœ‰ç¯€ç›®ï½œèˆªå‘ä¸–ç•Œæ—…éŠé »é“</title>

  <!-- ç«™å…§æ¨£å¼ -->
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="favicon.png" type="image/png">

  <!-- å¿…è¦å¥—ä»¶ï¼šContentful + Twemoji -->
  <script src="https://cdn.jsdelivr.net/npm/contentful@latest/dist/contentful.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js" crossorigin="anonymous"></script>

  <!-- æœ¬é æ¨£å¼ï¼ˆæ¥µç°¡ä¸»é¡Œæ©‹æ¥ + æ©«å‘åˆ†é¡æ¢ + å¡ç‰‡ç­‰é«˜ + å€å¡Šæ”¶åˆ + æ¨™ç±¤/å¾½ç« ï¼‰ -->
  <style>
    :root{ --bg:#ffffff; --text:#111827; --card:#ffffff; --card-border:rgba(0,0,0,.06); }
    --accent:#e0b46a;         /* é‡‘è‰²ï¼ˆä¾ index.htmlï¼‰ */
    --active-bg:#f6f6f6;      /* è¢«é¸å–æ™‚çš„æ·ºç°åº•ï¼ˆäº®è‰²ä¸»é¡Œï¼‰ */
   }
    .dark-theme{ --bg:#0b1620; --text:#e5eef9; --card:#0f2133; --card-border:rgba(255,255,255,.08); }
    --bg:#0b1620; --text:#e5eef9; --card:#0f2133; --card-border:rgba(255,255,255,.08);
    /* æ–°å¢ï¼šæš—è‰²ä¸»é¡Œæ™‚çš„é¸å–åº•è‰² */
   --active-bg:#0f2133;
    body{ background:var(--bg); color:var(--text); margin:0; }

    .page-wrap { max-width: 1200px; margin: 0 auto; padding: 24px 5%; }
    .page-head { display:flex; align-items:center; gap:12px; margin: 8px 0 16px; }
    .page-head h1 { font-weight:900; font-size:28px; margin:0; }
    .hint { color:#8aa4c2; font-size:14px; }

    /* === ä¸ƒå¤§æ´²å°è¦½ï¼ˆä¾ index.html é¢¨æ ¼ï¼šä¸­æ–‡ç²—ï¼‹è‹±æ–‡å°ï¼Œç„¡åœ–ç¤ºï¼Œé¸å–é‡‘è‰²ï¼‹æ·ºç°åº•ï¼‰ === */
.continent-menu{
  position: sticky; top: 64px; /* å¯ä¾ä½ çš„ navbar é«˜åº¦å¾®èª¿ */
  z-index: 20;
  display:flex; align-items:stretch; gap:0;
  padding:0; background:var(--bg);
  border-bottom:1px solid var(--card-border);
  overflow-x:auto; -webkit-overflow-scrolling:touch;
}
.continent-item{
  appearance:none; background:none; border:0; cursor:pointer;
  display:flex; align-items:center;
  padding:12px 20px; margin:0;
  text-align:left; line-height:1.15; position:relative;
  flex:0 0 auto; /* æ‰‹æ©Ÿå¯æ©«å‘æ»‘å‹• */
}
.continent-item .zh{ display:block; font-weight:900; color:var(--text); font-size:16px; letter-spacing:.02em; }
.continent-item .en{ display:block; font-size:12px; color:#8aa4c2; margin-top:2px; }

.divider{ width:1px; height:34px; align-self:center; background:var(--card-border); }
@media (max-width:900px){ .divider{ display:none; } }

/* hoverï¼šé‡‘è‰²æ–‡å­—ï¼ˆåŒ index.html çš„æ„Ÿè¦ºï¼‰ */
.continent-item:hover .zh,
.continent-item:hover .en{ color:var(--accent); }

/* activeï¼šæ•´å¡Šæ·¡ç°åº•ï¼‹é‡‘è‰²å­— */
.continent-item.active{ background:var(--active-bg); }
.continent-item.active .zh,
.continent-item.active .en{ color:var(--accent); }

/* æš—è‰²ä¸»é¡Œçš„å¾®èª¿ */
.dark-theme .continent-menu{ border-bottom-color:rgba(255,255,255,.1); }
.dark-theme .divider{ background:rgba(255,255,255,.12); }
.dark-theme .continent-item .en{ color:#93a6bf; }

@media (max-width:768px){
  .continent-item{ padding:10px 14px; }
  .continent-item .zh{ font-size:15px; }
  .continent-item .en{ font-size:11px; }
}

   

    @media (max-width:768px){
      .continent-item{ padding:6px 10px 8px; }
      .continent-item .zh{ font-size:15px; }
      .continent-item .en{ font-size:11px; }
      .continent-item .icon{ font-size:16px; }
    }

    /* === æ´²/åœ‹å®¶æ¨™é¡Œ === */
    .continent-title { margin:24px 0 12px; font-size:26px; font-weight:900; border-left:6px solid #3fa0ff; padding-left:10px; }
    .country-head{display:flex;align-items:center;gap:10px;margin:12px 0 6px}
    .country-title{margin:0;font-size:20px;font-weight:800;display:flex;align-items:center;gap:8px}
    .country-flag{font-size:22px;line-height:1;display:inline-flex;align-items:center}
    .country-flag img.emoji{height:1.2em;width:auto;vertical-align:-0.15em}
    .country-count{font-size:12px;font-weight:700;padding:2px 8px;border-radius:999px;background:#e9eef6;color:#0a2a4a}
    .dark-theme .country-count{background:#0f2a44;color:#cfe4ff}

    /* === å¡ç‰‡ï¼ˆç­‰é«˜ï¼‹æŒ‰éˆ•è²¼åº•å°é½Šï¼‰=== */
    .video-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
      gap:16px;
      align-items:stretch;
    }
    .video-card{
      display:flex; flex-direction:column;
      border-radius:16px; background:var(--card); border:1px solid var(--card-border);
      box-shadow:0 8px 24px rgba(0,0,0,.12); overflow:hidden;
    }
    .video-thumb{
      flex:0 0 auto; aspect-ratio:16/9; width:100%; overflow:hidden;
      border-bottom:1px solid var(--card-border); background:#e5e7eb;
    }
    .video-thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
    .video-content{ display:flex; flex-direction:column; gap:8px; flex:1 1 auto; padding:14px 16px; }
    .video-title{ font-weight:900; font-size:18px; margin:6px 0 0; line-height:1.35; color:var(--text); }
    .video-tags{ color:#8aa4c2; font-size:13px; margin-bottom:2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .video-desc{
      color:#93a6bf; font-size:14px; line-height:1.55; overflow:hidden;
      display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical;
      min-height:calc(1.55em * 3);
    }
    .video-cta{
      margin-top:auto; align-self:flex-start;
      padding:10px 14px; border-radius:12px; border:0; background:#3fa0ff; color:#001528; font-weight:800; cursor:pointer;
    }

    /* === æ”¶åˆ/å±•é–‹ï¼šæŸ”å’Œæ¼¸å±¤ + è† å›ŠæŒ‰éˆ• === */
    .grid-wrap{position:relative}
    .grid-wrap.is-collapsed .video-card:nth-child(n+7){display:none}   /* åªç•™å‰ 6 å¼µ */
    .grid-fade{position:absolute;left:0;right:0;bottom:0;height:72px;background:linear-gradient(to bottom,rgba(0,0,0,0),var(--bg));pointer-events:none;opacity:1;transition:opacity .25s ease}
    .grid-wrap.is-expanded .grid-fade{opacity:0}

    .country-more-btn{
      display:inline-flex;align-items:center;gap:8px;justify-content:center;
      margin:12px auto 28px;padding:10px 16px;border-radius:999px;border:1px solid var(--card-border);
      background:var(--card);color:var(--text);font-weight:800;cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,.06)
    }
    .country-more-btn:hover{transform:translateY(-1px)}
    .country-more-btn:active{transform:translateY(0)}
    .country-more-btn .chev{width:16px;height:16px;transition:transform .25s ease}
    .country-more-btn.expanded .chev{transform:rotate(180deg)}

    .placeholder { border:1px dashed #3a5b7b; border-radius:12px; padding:24px; color:#8aa4c2; text-align:center; }

    /* é€šç”¨éš±è—è¼”åŠ©ï¼ˆçµ¦æ´²åˆ‡æ›æ™‚ç”¨ï¼‰ */
    .is-hidden { display: none !important; }

    /* Twemoji çµ±ä¸€å°ºå¯¸ï¼ˆé¿å…è¢«å…¨ç«™ img è¦å‰‡å½±éŸ¿ï¼‰ */
    img.emoji { height: 1em; width: auto; vertical-align: -0.15em; display: inline; }
  </style>
</head>
<body>

  <!-- å°è¦½åˆ— -->
  <div class="navbar">
    <a class="logo" href="index.html"><img src="logo.png" alt="èˆªå‘ä¸–ç•Œæ—…éŠé »é“ LOGO" /></a>
    <nav class="desktop-nav">
      <a href="index.html">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9L12 2L21 9V20a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        <span class="nav-text">é¦–é </span>
      </a>
      <a href="videos.html">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><path d="M8 21h8m-4-4v4"/></svg>
        <span class="nav-text">æ‰€æœ‰ç¯€ç›®</span>
      </a>
      <a href="schedule.html">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
        <span class="nav-text">ç¯€ç›®è¡¨</span>
      </a>
      <a href="topics.html">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <span class="nav-text">ä¸»é¡Œæ¢ç´¢</span>
      </a>
    </nav>

    <div class="nav-actions">
      <a href="#" id="theme-switcher" title="åˆ‡æ›ä¸»é¡Œ">
        <svg id="theme-icon-sun" class="nav-icon" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
        <svg id="theme-icon-moon" class="nav-icon" style="display:none;" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
      </a>
      <a href="login.html" class="login-link">
        <svg class="nav-icon" viewBox="0 0 20 20" fill="none"><circle cx="10" cy="7" r="4.5" stroke-width="2"/><ellipse cx="10" cy="15.2" rx="6.8" ry="3.2" stroke-width="2"/></svg>
        <span class="nav-text">æœƒå“¡ç™»å…¥</span>
      </a>
      <button id="hamburger-btn" class="hamburger-btn">
        <svg viewBox="0 0 100 80" width="24" height="24"><rect width="100" height="15" rx="8"></rect><rect y="30" width="100" height="15" rx="8"></rect><rect y="60" width="100" height="15" rx="8"></rect></svg>
      </button>
    </div>
  </div>

  <div id="side-menu" class="side-menu">
    <a href="index.html">é¦–é </a>
    <a href="videos.html">æ‰€æœ‰ç¯€ç›®</a>
    <a href="schedule.html">ç¯€ç›®è¡¨</a>
    <a href="topics.html">ä¸»é¡Œæ¢ç´¢</a>
  </div>
  <div id="menu-overlay" class="menu-overlay"></div>

  <!-- å…§å®¹å€ï¼šæ‰€æœ‰ç¯€ç›® -->
  <main class="page-wrap">
    <div class="page-head">
      <h1>æ‰€æœ‰ç¯€ç›®</h1>
      <span class="hint">è‡ªå‹•ä¾ã€Œæ´² â†’ åœ‹å®¶ï¼ç¶œåˆã€åˆ†çµ„ï¼ˆå¾æ¨™é¡Œâ†’æ¨™ç±¤â†’èªªæ˜æ–‡å­—åµæ¸¬åœ‹å®¶ï¼‰</span>
    </div>
    <div id="all-videos"><div class="placeholder">è¼‰å…¥ä¸­â€¦</div></div>
  </main>

  <!-- ç«™å…§ JSï¼ˆä¸»é¡Œåˆ‡æ› / æ¼¢å ¡é¸å–®ç­‰ï¼‰ -->
  <script src="script.js"></script>

  <!-- æœ¬é é‚è¼¯ï¼šæ©«å‘åˆ†é¡æ¢ + è‡ªå‹•åˆ†é¡ + æ”¶åˆ/å±•é–‹ + åœ‹æ—— SVG + ç¯©é¸ -->
  <script>
  (function(){
    'use strict';

    const $ = (s, el=document) => el.querySelector(s);
    const escapeHtml = (s='') => String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');
    const norm = (str='') => String(str).trim().toLowerCase().replace(/\s+/g,' ').replace(/[()ï¼ãƒ»Â·â€šâ€™'Â´`â€™â€˜"]/g,'').replace(/å°/g,'è‡º');

    // å›ºå®šä¸ƒå¤§æ´²ï¼ˆå°è¦½ç”¨ï¼‰
    const CONTINENTS_7 = [
      { key:'asia',          label:'äºæ´²' },
      { key:'europe',        label:'æ­æ´²' },
      { key:'north_america', label:'åŒ—ç¾æ´²' },
      { key:'south_america', label:'å—ç¾æ´²' },
      { key:'africa',        label:'éæ´²' },
      { key:'oceania',       label:'å¤§æ´‹æ´²' },
      { key:'antarctica',    label:'å—æ¥µæ´²' },
    ];
    // å¯¦éš›æ¸²æŸ“æ™‚ä¹Ÿæœƒç”¨åˆ°ï¼ˆåŠ ä¸Š other ä»¥å®¹ç´æœªçŸ¥ï¼‰
    const CONTINENTS = [...CONTINENTS_7, { key:'other', label:'å…¶ä»–' }];

    const REGION_HINTS = new Map([
      ['æ±äº','asia'],['æ±åŒ—äº','asia'],['æ±å—äº','asia'],['å—äº','asia'],['ä¸­äº','asia'],['è¥¿äº','asia'],['ä¸­æ±','asia'],
      ['æ­æ´²','europe'],['åŒ—æ­','europe'],['æ±æ­','europe'],['è¥¿æ­','europe'],['ä¸­æ­','europe'],['åœ°ä¸­æµ·','europe'],['å·´çˆ¾å¹¹','europe'],['æ–¯å ªåœ°é‚£ç¶­äº','europe'],
      ['åŒ—ç¾','north_america'],['å—ç¾','south_america'],['ä¸­å—ç¾','south_america'],
      ['éæ´²','africa'],['æ’’å“ˆæ‹‰','africa'],['æ’’å“ˆæ‹‰ä»¥å—éæ´²','africa'],
      ['å¤§æ´‹æ´²','oceania'],['å—å¤ªå¹³æ´‹','oceania'],['å—æ¥µ','antarctica'],['å—æ¥µæ´²','antarctica'],
      ['east asia','asia'],['southeast asia','asia'],['south asia','asia'],['central asia','asia'],['middle east','asia'],
      ['europe','europe'],['mediterranean','europe'],['balkans','europe'],['scandinavia','europe'],['nordic','europe'],
      ['north america','north_america'],['south america','south_america'],['latin america','south_america'],
      ['africa','africa'],['sub-saharan','africa'],['oceania','oceania'],['antarctica','antarctica'],
    ]);

    // === åœ‹å®¶ç´¢å¼•ï¼ˆå¯æ…¢æ…¢æ“´å……ï¼‰===
    const COUNTRY_INDEX = [
      { country:'æ—¥æœ¬', aliases:['æ—¥æœ¬','ã«ã»ã‚“','nihon','nippon','japan','jp'], continent:'asia' },
      { country:'éŸ“åœ‹', aliases:['éŸ“åœ‹','å—éŸ“','ëŒ€í•œë¯¼êµ­','korea','south korea','kr'], continent:'asia' },
      { country:'å°ç£', aliases:['è‡ºç£','å°ç£','taiwan','tw'], continent:'asia' },
      { country:'ä¸­åœ‹', aliases:['ä¸­åœ‹','ä¸­åœ‹å¤§é™¸','china','cn'], continent:'asia' },
      { country:'è’™å¤', aliases:['è’™å¤','mongolia','mn'], continent:'asia' },
      { country:'å“ˆè–©å…‹', aliases:['å“ˆè–©å…‹','å“ˆè–©å…‹æ–¯å¦','kazakhstan','kz'], continent:'asia' },
      { country:'å‰çˆ¾å‰æ–¯', aliases:['å‰çˆ¾å‰æ–¯','å‰çˆ¾å‰æ–¯æ–¯å¦','kyrgyzstan','kg','kirgiz'], continent:'asia' },
      { country:'çƒèŒ²åˆ¥å…‹', aliases:['çƒèŒ²åˆ¥å…‹','çƒèŒ²åˆ¥å…‹æ–¯å¦','uzbekistan','uz'], continent:'asia' },
      { country:'å¡”å‰å…‹', aliases:['å¡”å‰å…‹','å¡”å‰å…‹æ–¯å¦','tajikistan','tj'], continent:'asia' },
      { country:'åœŸåº«æ›¼', aliases:['åœŸåº«æ›¼','åœŸåº«æ›¼æ–¯å¦','turkmenistan','tm'], continent:'asia' },
      { country:'å°åº¦', aliases:['å°åº¦','india','in'], continent:'asia' },
      { country:'æ³°åœ‹', aliases:['æ³°åœ‹','thailand','th'], continent:'asia' },
      { country:'è¶Šå—', aliases:['è¶Šå—','vietnam','vn'], continent:'asia' },
      { country:'é¦¬ä¾†è¥¿äº', aliases:['é¦¬ä¾†è¥¿äº','malaysia','my'], continent:'asia' },
      { country:'å°å°¼', aliases:['å°å°¼','å°åº¦å°¼è¥¿äº','indonesia','id'], continent:'asia' },
      { country:'å°¼æ³Šçˆ¾', aliases:['å°¼æ³Šçˆ¾','nepal','np'], continent:'asia' },
      { country:'ä»¥è‰²åˆ—', aliases:['ä»¥è‰²åˆ—','israel','il'], continent:'asia' },
      { country:'ç´„æ—¦', aliases:['ç´„æ—¦','jordan','jo'], continent:'asia' },
      { country:'åœŸè€³å…¶', aliases:['åœŸè€³å…¶','turkiye','turkey','tr'], continent:'asia' },
      { country:'ä¼Šæœ—', aliases:['ä¼Šæœ—','iran','ir'], continent:'asia' },
      { country:'ä¸ä¸¹', aliases:['ä¸ä¸¹','bhutan','bt'], continent:'asia' },
      // ä¿„ç¾…æ–¯ï¼ˆæ­¸åœ¨ã€Œäºæ´²ã€ä»¥å®¹ç´è¥¿ä¼¯åˆ©äºç­‰ï¼‰
      { country:'ä¿„ç¾…æ–¯', aliases:['ä¿„ç¾…æ–¯','russia','ru','è¥¿ä¼¯åˆ©äº','siberia'], continent:'asia' },

      { country:'èŠ¬è˜­', aliases:['èŠ¬è˜­','finland','fi'], continent:'europe' },
      { country:'æŒªå¨', aliases:['æŒªå¨','norway','no'], continent:'europe' },
      { country:'ç‘å…¸', aliases:['ç‘å…¸','sweden','se'], continent:'europe' },
      { country:'ç‘å£«', aliases:['ç‘å£«','switzerland','ch'], continent:'europe' },
      { country:'è‹±åœ‹', aliases:['è‹±åœ‹','uk','united kingdom','england','scotland','wales','northern ireland','gb'], continent:'europe' },
      { country:'æ³•åœ‹', aliases:['æ³•åœ‹','france','fr'], continent:'europe' },
      { country:'å¾·åœ‹', aliases:['å¾·åœ‹','germany','de'], continent:'europe' },
      { country:'ç¾©å¤§åˆ©', aliases:['ç¾©å¤§åˆ©','æ„å¤§åˆ©','italy','it'], continent:'europe' },
      { country:'è¥¿ç­ç‰™', aliases:['è¥¿ç­ç‰™','spain','es'], continent:'europe' },
      { country:'è‘¡è„ç‰™', aliases:['è‘¡è„ç‰™','portugal','pt'], continent:'europe' },
      { country:'æ·å…‹', aliases:['æ·å…‹','czech','czechia','cz'], continent:'europe' },
      { country:'å¥§åœ°åˆ©', aliases:['å¥§åœ°åˆ©','austria','at'], continent:'europe' },
      { country:'å†°å³¶', aliases:['å†°å³¶','iceland','is'], continent:'europe' },

      { country:'ç¾åœ‹', aliases:['ç¾åœ‹','usa','us','united states','america','u.s.'], continent:'north_america' },
      { country:'åŠ æ‹¿å¤§', aliases:['åŠ æ‹¿å¤§','canada','ca'], continent:'north_america' },
      { country:'å¢¨è¥¿å“¥', aliases:['å¢¨è¥¿å“¥','mexico','mx'], continent:'north_america' },

      { country:'å·´è¥¿', aliases:['å·´è¥¿','brazil','br'], continent:'south_america' },
      { country:'é˜¿æ ¹å»·', aliases:['é˜¿æ ¹å»·','argentina','ar'], continent:'south_america' },
      { country:'æ™ºåˆ©', aliases:['æ™ºåˆ©','chile','cl'], continent:'south_america' },
      { country:'ç¥•é­¯', aliases:['ç¥•é­¯','ç§˜é­¯','peru','pe'], continent:'south_america' },
      { country:'ç»åˆ©ç¶­äº', aliases:['ç»åˆ©ç¶­äº','bolivia','bo'], continent:'south_america' },
      { country:'å“¥å€«æ¯”äº', aliases:['å“¥å€«æ¯”äº','colombia','co'], continent:'south_america' },

      { country:'å—é', aliases:['å—é','south africa','za'], continent:'africa' },
      { country:'è‚¯äº', aliases:['è‚¯äº','kenya','ke'], continent:'africa' },
      { country:'æ‘©æ´›å“¥', aliases:['æ‘©æ´›å“¥','morocco','ma'], continent:'africa' },
      { country:'åŸƒåŠ', aliases:['åŸƒåŠ','egypt','eg'], continent:'africa' },
      { country:'å¦å°šå°¼äº', aliases:['å¦å°šå°¼äº','å¦æ¡‘å°¼äº','tanzania','tz'], continent:'africa' },

      { country:'æ¾³æ´²', aliases:['æ¾³æ´²','æ¾³å¤§åˆ©äº','australia','au'], continent:'oceania' },
      { country:'ç´è¥¿è˜­', aliases:['ç´è¥¿è˜­','æ–°è¥¿è˜­','new zealand','nz'], continent:'oceania' },
    ];

    const COUNTRY_FLAGS = {
      'æ—¥æœ¬':'ğŸ‡¯ğŸ‡µ','éŸ“åœ‹':'ğŸ‡°ğŸ‡·','å°ç£':'ğŸ‡¹ğŸ‡¼','ä¸­åœ‹':'ğŸ‡¨ğŸ‡³','è’™å¤':'ğŸ‡²ğŸ‡³','å“ˆè–©å…‹':'ğŸ‡°ğŸ‡¿','å‰çˆ¾å‰æ–¯':'ğŸ‡°ğŸ‡¬','çƒèŒ²åˆ¥å…‹':'ğŸ‡ºğŸ‡¿','å¡”å‰å…‹':'ğŸ‡¹ğŸ‡¯','åœŸåº«æ›¼':'ğŸ‡¹ğŸ‡²',
      'å°åº¦':'ğŸ‡®ğŸ‡³','æ³°åœ‹':'ğŸ‡¹ğŸ‡­','è¶Šå—':'ğŸ‡»ğŸ‡³','é¦¬ä¾†è¥¿äº':'ğŸ‡²ğŸ‡¾','å°å°¼':'ğŸ‡®ğŸ‡©','å°¼æ³Šçˆ¾':'ğŸ‡³ğŸ‡µ','ä»¥è‰²åˆ—':'ğŸ‡®ğŸ‡±','ç´„æ—¦':'ğŸ‡¯ğŸ‡´','åœŸè€³å…¶':'ğŸ‡¹ğŸ‡·','ä¼Šæœ—':'ğŸ‡®ğŸ‡·','ä¸ä¸¹':'ğŸ‡§ğŸ‡¹',
      'ä¿„ç¾…æ–¯':'ğŸ‡·ğŸ‡º','èŠ¬è˜­':'ğŸ‡«ğŸ‡®','æŒªå¨':'ğŸ‡³ğŸ‡´','ç‘å…¸':'ğŸ‡¸ğŸ‡ª','ç‘å£«':'ğŸ‡¨ğŸ‡­','è‹±åœ‹':'ğŸ‡¬ğŸ‡§','æ³•åœ‹':'ğŸ‡«ğŸ‡·','å¾·åœ‹':'ğŸ‡©ğŸ‡ª','ç¾©å¤§åˆ©':'ğŸ‡®ğŸ‡¹','è¥¿ç­ç‰™':'ğŸ‡ªğŸ‡¸','è‘¡è„ç‰™':'ğŸ‡µğŸ‡¹','æ·å…‹':'ğŸ‡¨ğŸ‡¿','å¥§åœ°åˆ©':'ğŸ‡¦ğŸ‡¹','å†°å³¶':'ğŸ‡®ğŸ‡¸',
      'ç¾åœ‹':'ğŸ‡ºğŸ‡¸','åŠ æ‹¿å¤§':'ğŸ‡¨ğŸ‡¦','å¢¨è¥¿å“¥':'ğŸ‡²ğŸ‡½',
      'å·´è¥¿':'ğŸ‡§ğŸ‡·','é˜¿æ ¹å»·':'ğŸ‡¦ğŸ‡·','æ™ºåˆ©':'ğŸ‡¨ğŸ‡±','ç¥•é­¯':'ğŸ‡µğŸ‡ª','ç»åˆ©ç¶­äº':'ğŸ‡§ğŸ‡´','å“¥å€«æ¯”äº':'ğŸ‡¨ğŸ‡´',
      'å—é':'ğŸ‡¿ğŸ‡¦','è‚¯äº':'ğŸ‡°ğŸ‡ª','æ‘©æ´›å“¥':'ğŸ‡²ğŸ‡¦','åŸƒåŠ':'ğŸ‡ªğŸ‡¬','å¦å°šå°¼äº':'ğŸ‡¹ğŸ‡¿',
      'æ¾³æ´²':'ğŸ‡¦ğŸ‡º','ç´è¥¿è˜­':'ğŸ‡³ğŸ‡¿'
    };
    const getFlag = (country) => COUNTRY_FLAGS[country] || '';

    // === åˆ¥åç´¢å¼•ï¼ˆåœ‹å + å¸¸è¦‹åŸå¸‚/åœ°æ¨™ï¼‰===
    const ALIAS_EXACT = new Map();   // ç”¨æ–¼ tags ç²¾æº–å‘½ä¸­
    const ALIAS_TEXT  = [];          // ç”¨æ–¼æ¨™é¡Œ/æè¿°åŒ…å«æ¯”å°

    // åœ‹åï¼ˆæ¬Šé‡ 2ï¼‰
    for (const row of COUNTRY_INDEX) {
      for (const a of row.aliases) {
        const key = norm(a);
        const val = { country: row.country, continent: row.continent };
        ALIAS_EXACT.set(key, val);
        if (key.length >= 2) ALIAS_TEXT.push({ alias: key, ...val, weight: 2 });
      }
    }

    // åŸå¸‚/åœ°æ¨™ï¼ˆæ¬Šé‡ 1ï¼‰
    const CITY_ALIASES = [
      // å°å°¼
      ['é›…åŠ é”','å°å°¼','asia'], ['æ—¥æƒ¹','å°å°¼','asia'], ['æ³—æ°´','å°å°¼','asia'], ['è¬éš†','å°å°¼','asia'],
      ['å³‡é‡Œ','å°å°¼','asia'], ['å·´é‡Œå³¶','å°å°¼','asia'], ['å³‡é‡Œå³¶','å°å°¼','asia'], ['é¾ç›®','å°å°¼','asia'],
      ['çˆªå“‡','å°å°¼','asia'], ['è˜‡é–€ç­”è‡˜','å°å°¼','asia'],
      // æ³°åœ‹
      ['æ›¼è°·','æ³°åœ‹','asia'], ['æ¸…é‚','æ³°åœ‹','asia'], ['æ™®å‰','æ³°åœ‹','asia'], ['èŠ­é”é›…','æ³°åœ‹','asia'],
      // è¶Šå—
      ['èƒ¡å¿—æ˜','è¶Šå—','asia'], ['æ²³å…§','è¶Šå—','asia'], ['å³´æ¸¯','è¶Šå—','asia'],
      // åœŸè€³å…¶
      ['ä¼Šæ–¯å¦å ¡','åœŸè€³å…¶','asia'], ['å¡å¸•å¤šå¥‡äº','åœŸè€³å…¶','asia'], ['å®‰å¡æ‹‰','åœŸè€³å…¶','asia'],
      // æ—¥æœ¬
      ['æ±äº¬','æ—¥æœ¬','asia'], ['å¤§é˜ª','æ—¥æœ¬','asia'], ['äº¬éƒ½','æ—¥æœ¬','asia'], ['æ²–ç¹©','æ—¥æœ¬','asia'],
      // é¦¬ä¾†è¥¿äº
      ['å‰éš†å¡','é¦¬ä¾†è¥¿äº','asia'], ['æª³åŸ','é¦¬ä¾†è¥¿äº','asia'], ['äºåº‡','é¦¬ä¾†è¥¿äº','asia'],
      // ä¿„ç¾…æ–¯ / è‚¯äº / ç‘å£«
      ['è²åŠ çˆ¾æ¹–','ä¿„ç¾…æ–¯','asia'], ['baikal','ä¿„ç¾…æ–¯','asia'], ['baikai','ä¿„ç¾…æ–¯','asia'],
      ['é¦¬è³½é¦¬æ‹‰','è‚¯äº','africa'], ['masai mara','è‚¯äº','africa'],
      ['è˜‡é»ä¸–','ç‘å£«','europe'], ['æ—¥å…§ç“¦','ç‘å£«','europe'],
      // è‹±æ–‡å¸¸è¦‹æ‹¼å¯«
      ['jakarta','å°å°¼','asia'], ['bali','å°å°¼','asia'], ['yogyakarta','å°å°¼','asia'], ['bandung','å°å°¼','asia'],
      ['surabaya','å°å°¼','asia'], ['bangkok','æ³°åœ‹','asia'], ['chiang mai','æ³°åœ‹','asia'], ['phuket','æ³°åœ‹','asia'],
      ['istanbul','åœŸè€³å…¶','asia'], ['cappadocia','åœŸè€³å…¶','asia'], ['tokyo','æ—¥æœ¬','asia'], ['kyoto','æ—¥æœ¬','asia'],
      ['osaka','æ—¥æœ¬','asia'], ['okinawa','æ—¥æœ¬','asia'], ['kuala lumpur','é¦¬ä¾†è¥¿äº','asia'], ['penang','é¦¬ä¾†è¥¿äº','asia'],
      ['geneva','ç‘å£«','europe'], ['zurich','ç‘å£«','europe'],
    ];
    for (const [alias, country, continent] of CITY_ALIASES) {
      const k = norm(alias);
      const val = { country, continent };
      ALIAS_EXACT.set(k, val);                         // tags å‘½ä¸­
      ALIAS_TEXT.push({ alias: k, ...val, weight: 1 }); // æ–‡å­—å‘½ä¸­
    }
    // é•·å­—å„ªå…ˆï¼›åŒé•·æ™‚ã€Œåœ‹å(2)ã€å„ªå…ˆæ–¼ã€ŒåŸå¸‚(1)ã€
    ALIAS_TEXT.sort((a, b) => (b.alias.length - a.alias.length) || (b.weight - a.weight));

    function guessCountryAndContinent({ title='', desc='', tags=[] }) {
      const nt = norm(title), nd = norm(desc);
      const nTags = (Array.isArray(tags) ? tags : []).map(t => norm(String(t))).filter(Boolean);

      // å…ˆçœ‹ tags æ˜¯å¦ç›´æ¥å‘½ä¸­
      for (const t of nTags) { const hit = ALIAS_EXACT.get(t); if (hit) return hit; }
      // å†çœ‹æ¨™é¡Œ â†’ èªªæ˜æ–‡å­—
      for (const row of ALIAS_TEXT) if (nt.includes(row.alias)) return row;
      for (const row of ALIAS_TEXT) if (nd.includes(row.alias)) return row;

      // å†çœ‹å€åŸŸæç¤ºè©
      for (const t of nTags) { const cont = REGION_HINTS.get(t); if (cont) return { country:null, continent:cont }; }
      for (const [hint, cont] of REGION_HINTS.entries()) {
        const h = norm(hint); if (h.length>2 && (nt.includes(h) || nd.includes(h))) return { country:null, continent:cont };
      }
      return { country:null, continent:'other' };
    }

    function classifyItem(v) {
      const { country, continent } = guessCountryAndContinent({ title:v.title||'', desc:v.desc||'', tags:v.tags||[] });
      const contKey = continent || 'other';
      const contLabel = (CONTINENTS.find(c=>c.key===contKey)||{label:'å…¶ä»–'}).label;
      let countryKey = country ? norm(country) : 'mixed';
      let countryLabel = country || 'ç¶œåˆ';
      return { continentKey:contKey, continentLabel:contLabel, countryKey, countryLabel };
    }

    (async function run(){
      const container = $('#all-videos');
      if (!container) return;
      container.innerHTML = '<div class="placeholder">è¼‰å…¥ä¸­â€¦</div>';

      let res;
      try {
        const client = window.contentful.createClient({
          space: 'os5wf90ljenp',
          accessToken: 'lODH-WLwHwVZv7O4rFdBWjSnrzaQWGD4koeOZ1Dypj0'
        });
        res = await client.getEntries({ content_type:'video', order:'-sys.updatedAt', limit:500 });
      } catch (e) {
        console.error('Contentful é€£ç·šå¤±æ•—ï¼ˆvideos.htmlï¼‰ï¼š', e);
        container.innerHTML = '<div class="placeholder">âŒ ç›®å‰ç„¡æ³•è¼‰å…¥æ‰€æœ‰ç¯€ç›®ã€‚</div>';
        return;
      }

      const pick = (obj, keys) => { for (const k of keys) if (obj && obj[k]!=null && obj[k]!=='') return obj[k]; return ''; };
      const items = (res.items||[]).map(it=>{
        const f = it.fields||{};
        const title = pick(f,['å½±ç‰‡æ¨™é¡Œ','title']);
        const desc  = pick(f,['ç²¾é¸æ¨è–¦å½±ç‰‡èªªæ˜æ–‡å­—','description']);
        const ytid  = pick(f,['YouTube ID','youTubeId']);
        const mp4   = pick(f,['MP4 å½±ç‰‡ç¶²å€','mp4Url']);
        const tags  = Array.isArray(f.tags)?f.tags:[];
        let thumb   = f.thumbnail?.fields?.file?.url || '';
        if (thumb && !thumb.startsWith('http')) thumb = 'https:' + thumb;
        if (!thumb && ytid) thumb = `https://i.ytimg.com/vi/${ytid}/hqdefault.jpg`;
        return { title, desc, ytid, mp4, tags, thumb };
      });

      // åˆ†çµ„
      const groups = {};
      for (const v of items) {
        const slot = classifyItem(v);
        groups[slot.continentKey] ??= { label: slot.continentLabel, countries:{} };
        groups[slot.continentKey].countries[slot.countryKey] ??= { label: slot.countryLabel, items: [] };
        groups[slot.continentKey].countries[slot.countryKey].items.push(v);
      }

      // æ¸²æŸ“
      container.innerHTML = '';

      // === æ´²åˆ¥å›ºå®šå°è¦½ï¼ˆä¸ƒå¤§æ´²ï¼‰ â†’ æ©«å‘åˆ†é¡æ¢ ===
      const nav = document.createElement('nav');
      nav.className = 'continent-menu';

      const mapEn = {
        asia:'Asia', europe:'Europe', north_america:'North America',
        south_america:'South America', africa:'Africa', oceania:'Oceania', antarctica:'Antarctica'
      };

      /* æ–°å¢ï¼šicon å°æ‡‰ */
      const ICONS = {
        asia: 'ğŸŒ',
        europe: 'ğŸŒ',
        north_america: 'ğŸŒ',
        south_america: 'ğŸŒ',
        africa: 'ğŸŒ',
        oceania: 'ğŸŒ',
        antarctica: 'ğŸ§Š',
        all: 'â­'
      };

      function makeItem(key, zh, en){
        const btn = document.createElement('button');
        btn.className = 'continent-item';
        btn.type = 'button';
        const icon = ICONS[key] || 'ğŸ—ºï¸';
        btn.dataset.key = key;
        btn.innerHTML = `
          <span class="icon">${icon}</span>
          <span class="zh">${zh}</span>
          <span class="en">${en}</span>`;
        return btn;
      }

      CONTINENTS_7.forEach((c, i) => {
        const btn = makeItem(c.key, c.label, mapEn[c.key] || '');
        nav.appendChild(btn);
        if (i < CONTINENTS_7.length - 1) {
          const divi = document.createElement('i');
          divi.className = 'divider';
          divi.setAttribute('aria-hidden', 'true');
          nav.appendChild(divi);
        }
      });

      // å³å´åŠ ä¸Šä¸€é¡†ã€Œå…¨éƒ¨ã€
      const divLast = document.createElement('i');
      divLast.className = 'divider';
      divLast.setAttribute('aria-hidden', 'true');
      nav.appendChild(divLast);
      const showAllBtn = document.createElement('button');
      showAllBtn.className = 'continent-item';
      showAllBtn.type = 'button';
      showAllBtn.innerHTML = `
        <span class="icon">${ICONS.all}</span>
        <span class="zh">å…¨éƒ¨</span>
        <span class="en">All</span>`;
      nav.appendChild(showAllBtn);

      container.appendChild(nav);

      // === å„æ´²å…§å®¹ ===
      for (const c of CONTINENTS) {
        const node = groups[c.key];
        if (!node) continue;

        const contSection = document.createElement('section');
        contSection.id = `cont-${c.key}`;
        contSection.innerHTML = `<h2 class="continent-title">${node.label}</h2><div class="continent-body"></div>`;
        container.appendChild(contSection);
        const body = contSection.querySelector('.continent-body');

        const entries = Object.entries(node.countries).sort((a,b)=>{
          const A = a[1].label === 'ç¶œåˆ' ? '~~~' : a[1].label;
          const B = b[1].label === 'ç¶œåˆ' ? '~~~' : b[1].label;
          return String(A).localeCompare(String(B), 'zh-Hant');
        });

        for (const [ckey, bucket] of entries) {
          const flag = bucket.label === 'ç¶œåˆ' ? '' : getFlag(bucket.label);
          const block = document.createElement('div');
          block.id = `country-${c.key}-${ckey}`;
          block.innerHTML = `
            <div class="country-head">
              <h3 class="country-title">
                ${flag ? `<span class="country-flag">${flag}</span>` : ''}${bucket.label}
              </h3>
              <span class="country-count">å…± ${bucket.items.length} æ”¯</span>
            </div>
            <div class="grid-wrap">
              <div class="video-grid"></div>
              <div class="grid-fade" style="${bucket.items.length>6?'':'display:none'}"></div>
            </div>`;
          body.appendChild(block);

          const wrap = block.querySelector('.grid-wrap');
          const grid = wrap.querySelector('.video-grid');
          const frag = document.createDocumentFragment();

          bucket.items.forEach(v=>{
            const safeTitle = escapeHtml(v.title || 'æœªå‘½åå½±ç‰‡');
            const safeDesc  = v.desc ? escapeHtml(v.desc) : '';
            const ytFallback = v.ytid ? `https://i.ytimg.com/vi/${v.ytid}/hqdefault.jpg` : '';

            const card = document.createElement('div');
            card.className = 'video-card';
            card.innerHTML = `
              <div class="video-thumb">
                ${v.thumb ? `<img src="${v.thumb}" alt="${safeTitle}" loading="lazy" decoding="async"
                              onerror="this.onerror=null;this.src='${ytFallback}';">`
                          : `<div style="width:100%;height:100%;background:#e5e7eb;"></div>`}
              </div>
              <div class="video-content">
                ${Array.isArray(v.tags)&&v.tags.length ? `<div class="video-tags">${v.tags.map(t=>escapeHtml(String(t))).join(' / ')}</div>` : ``}
                <div class="video-title">${safeTitle}</div>
                ${safeDesc ? `<div class="video-desc">${safeDesc}</div>` : ``}
                ${
                  v.ytid
                    ? `<button class="video-cta" data-videoid="${escapeHtml(v.ytid)}">ç«‹å³è§€çœ‹</button>`
                    : (v.mp4 ? `<a class="video-cta" href="${escapeHtml(v.mp4)}" target="_blank" rel="noopener">æ’­æ”¾ MP4</a>` : ``)
                }
              </div>`;
            frag.appendChild(card);
          });
          grid.appendChild(frag);

          // é¡¯ç¤ºæ›´å¤š / æ”¶åˆ
          const MAX_PER_COUNTRY = 6;
          if (bucket.items.length > MAX_PER_COUNTRY) {
            wrap.classList.add('is-collapsed');
            const btn = document.createElement('button');
            btn.className = 'country-more-btn';
            btn.innerHTML = `
              <span class="lbl">é¡¯ç¤ºæ›´å¤š</span>
              <svg class="chev" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
              <span class="more-count">ï¼ˆ+${bucket.items.length - MAX_PER_COUNTRY}ï¼‰</span>`;
            btn.addEventListener('click', () => {
              const expanded = wrap.classList.toggle('is-expanded');
              wrap.classList.toggle('is-collapsed', !expanded);
              btn.classList.toggle('expanded', expanded);
              btn.querySelector('.lbl').textContent = expanded ? 'æ”¶åˆ' : 'é¡¯ç¤ºæ›´å¤š';
              const mc = btn.querySelector('.more-count');
              if (mc) mc.textContent = expanded ? '' : `ï¼ˆ+${bucket.items.length - MAX_PER_COUNTRY}ï¼‰`;
              const fade = wrap.querySelector('.grid-fade');
              if (fade) fade.style.opacity = expanded ? '0' : '1';
            });
            block.appendChild(btn);
          }
        }
      }

      // åªæŠŠã€Œåœ‹æ——ã€è½‰æˆ SVGï¼ˆé¿å…æè¿°ä¸­çš„ emoji è¢«æ”¾å¤§ï¼‰
      if (window.twemoji) {
        document.querySelectorAll('.country-flag').forEach(node => {
          twemoji.parse(node, {
            base: 'https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/',
            folder: 'svg',
            ext: '.svg'
          });
        });
      }

      // é»å¡ç‰‡æ’­æ”¾ï¼ˆæ²¿ç”¨é¦–é å…¨è¢å¹•æ’­æ”¾å™¨ï¼Œå¦å‰‡æ–°åˆ†é ï¼‰
      document.body.addEventListener('click', (e)=>{
        const btn = e.target?.closest?.('.video-cta');
        if (!btn) return;
        const id = btn.dataset.videoid;
        if (!id) return;
        if (typeof window.openFullscreenPlayer === 'function') {
          window.openFullscreenPlayer(id);
        } else {
          window.open(`https://www.youtube.com/watch?v=${encodeURIComponent(id)}`, '_blank', 'noopener');
        }
      });

      /* =========================
         å°è¦½äº’å‹•ï¼šactive / ç¯©é¸ / éŒ¨é» / è‡ªå‹•å±•é–‹
         ========================= */
      const navItems = nav.querySelectorAll('.continent-item'); // å«ä¸ƒæ´²ï¼Œä¸å«æœ€å¾Œçš„ã€Œå…¨éƒ¨ã€ï¼ˆä¸‹æ–¹å¦è¡Œè™•ç†ï¼‰

      function setActive(key){
        navItems.forEach(el => el.classList.toggle('active', el.dataset.key === key));
        showAllBtn.classList.toggle('active', !key); // æ²’ key ä»£è¡¨é¡¯ç¤ºå…¨éƒ¨
      }

      // å–å¾—æ‰€æœ‰æ´²çš„ section ç¯€é»ï¼ˆid å½¢å¦‚ cont-asiaï¼‰
      const allContinentSections = () => Array.from(document.querySelectorAll('[id^="cont-"]'));

      function filterByContinent(key){
        // é«˜äº®
        setActive(key);
        // é¡¯ç¤ºè©²æ´²ã€éš±è—å…¶ä»–
        const sections = allContinentSections();
        sections.forEach(sec=>{
          const isTarget = sec.id === `cont-${key}`;
          sec.classList.toggle('is-hidden', !isTarget);
        });
        // æ›´æ–° hash
        const url = new URL(window.location);
        url.hash = `cont-${key}`;
        history.replaceState(null, "", url);
        // æ²å‹•å°±ä½
        const target = document.getElementById(`cont-${key}`);
        if (target) target.scrollIntoView({ behavior:'smooth', block:'start' });
      }

      function showAll(){
        setActive(null);
        allContinentSections().forEach(sec=>sec.classList.remove('is-hidden'));
        const url = new URL(window.location);
        url.hash = '';
        history.replaceState(null, "", url);
      }

      // ç¶å®šå°è¦½é»æ“Šè¡Œç‚ºï¼ˆä¸ƒæ´²ï¼‰
      navItems.forEach(el=>{
        el.addEventListener('click', (ev)=>{
          ev.preventDefault();
          const key = el.dataset.key;
          filterByContinent(key);
          // åˆ‡æ›æ´²æ™‚è‡ªå‹•å±•é–‹è©²æ´²ç¬¬ä¸€å€‹åœ‹å®¶ï¼Œä¸¦æ”¶åˆå…¶ä»–
          collapseAllCountryGrids();
          expandFirstCountryIn(key);
        }, { passive:false });
      });

      // ã€Œå…¨éƒ¨ã€æŒ‰éˆ•
      showAllBtn.addEventListener('click', (ev)=>{
        ev.preventDefault();
        showAll();
        collapseAllCountryGrids(); // é¡¯ç¤ºå…¨éƒ¨æ™‚ä¿æŒæ‰€æœ‰åœ‹å®¶æ”¶åˆ
      }, { passive:false });

      // è¼‰å…¥æ™‚æ ¹æ“š hash å¥—ç”¨
      (function initFromHash(){
        const h = location.hash.replace(/^#/, '');
        const mm = h.match(/^cont\-(asia|europe|north_america|south_america|africa|oceania|antarctica)$/);
        if (mm) {
          filterByContinent(mm[1]);
          collapseAllCountryGrids();
          expandFirstCountryIn(mm[1]);
        } else {
          showAll();
          collapseAllCountryGrids();
        }
      })();

      // hash æ”¹è®Šæ™‚ä¹ŸåŒæ­¥
      window.addEventListener('hashchange', ()=>{
        const h = location.hash.replace(/^#/, '');
        const mm = h.match(/^cont\-(asia|europe|north_america|south_america|africa|oceania|antarctica)$/);
        if (mm) {
          filterByContinent(mm[1]);
          collapseAllCountryGrids();
          expandFirstCountryIn(mm[1]);
        } else {
          showAll();
          collapseAllCountryGrids();
        }
      });

      // å±•é–‹/æ”¶åˆè¼”åŠ©ï¼šä¾›ä¸Šè¿°åˆ‡æ›æ™‚å‘¼å«
      function collapseAllCountryGrids(){
        const wraps = document.querySelectorAll('.grid-wrap');
        wraps.forEach(wrap=>{
          const grid = wrap.querySelector('.video-grid');
          const total = grid ? grid.children.length : 0;
          const max = 6; // èˆ‡æ¸²æŸ“æ™‚ä¸€è‡´
          const btn = wrap.parentElement.querySelector('.country-more-btn');

          wrap.classList.remove('is-expanded');
          if (total > max) {
            wrap.classList.add('is-collapsed');
            const fade = wrap.querySelector('.grid-fade');
            if (fade) fade.style.opacity = '1';
            if (btn){
              btn.classList.remove('expanded');
              const lbl = btn.querySelector('.lbl'); if (lbl) lbl.textContent = 'é¡¯ç¤ºæ›´å¤š';
              const mc  = btn.querySelector('.more-count'); if (mc) mc.textContent = `ï¼ˆ+${Math.max(total - max, 0)}ï¼‰`;
            }
          } else {
            wrap.classList.remove('is-collapsed');
            if (btn){
              btn.classList.remove('expanded');
              const lbl = btn.querySelector('.lbl'); if (lbl) lbl.textContent = '';
              const mc  = btn.querySelector('.more-count'); if (mc) mc.textContent = '';
            }
          }
        });
      }

      function expandFirstCountryIn(contKey){
        const sec = document.getElementById(`cont-${contKey}`);
        if (!sec) return;
        const firstWrap = sec.querySelector('.grid-wrap');
        if (!firstWrap) return;

        const grid = firstWrap.querySelector('.video-grid');
        const total = grid ? grid.children.length : 0;
        const max = 6; // èˆ‡æ¸²æŸ“æ™‚ä¸€è‡´
        const btn = firstWrap.parentElement.querySelector('.country-more-btn');

        if (total > max){
          firstWrap.classList.remove('is-collapsed');
          firstWrap.classList.add('is-expanded');
          const fade = firstWrap.querySelector('.grid-fade');
          if (fade) fade.style.opacity = '0';
          if (btn){
            btn.classList.add('expanded');
            const lbl = btn.querySelector('.lbl'); if (lbl) lbl.textContent = 'æ”¶åˆ';
            const mc  = btn.querySelector('.more-count'); if (mc) mc.textContent = '';
          }
        }
      }
    })();
  })();
  </script>
</body>
</html>
