<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>æ‰€æœ‰ç¯€ç›®ï½œèˆªå‘ä¸–ç•Œæ—…éŠé »é“</title>

  <!-- ä½ çš„å…¨ç«™æ¨£å¼ï¼ˆå¯ç•™å¯æ‹¿æ‰ï¼›æ²’æœ‰ä¹Ÿä¸å½±éŸ¿ï¼Œä¸‹é¢æœ‰ä¿åº•æ¨£å¼ï¼‰ -->
  <link rel="stylesheet" href="style.css">

  <!-- Contentful SDK -->
  <script src="https://cdn.jsdelivr.net/npm/contentful@latest/dist/contentful.browser.min.js"></script>
  <!-- Twemojiï¼šæŠŠåœ‹æ—— emoji è½‰æˆ SVGï¼Œè§£æ±º Windows åªé¡¯ç¤ºå­—æ¯å•é¡Œ -->
  <script src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js" crossorigin="anonymous"></script>

  <style>
    /* ä¿åº•æ¨£å¼ï¼ˆä½ çš„ style.css æœƒè“‹éï¼‰ */
    :root { --card-bg:#f3f4f6; }
    body { margin:0; font-family: 'Noto Sans TC', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "PingFang TC", "Microsoft JhengHei", sans-serif; background:#0b1620; color:#e5eef9; }
    .page-wrap { max-width: 1200px; margin: 0 auto; padding: 24px 5%; }
    .page-head { display:flex; align-items:center; gap:12px; margin: 4px 0 16px; }
    .page-head h1 { font-weight: 900; font-size: 28px; margin: 0; }
    .hint { color:#8aa4c2; font-size:14px; }
    .quick-nav { display:flex; gap:8px; flex-wrap:wrap; margin: 10px 0 18px; }
    .quick-nav a { padding:6px 10px; border-radius:999px; background:#15314a; color:#b9d7ff; font-weight:700; text-decoration:none; }
    .continent-title { margin:24px 0 12px; font-size:26px; font-weight:900; border-left:6px solid #3fa0ff; padding-left:10px; }
    .country-title { margin:12px 0 8px; font-size:20px; font-weight:800; display:flex; align-items:center; gap:8px; }
    .country-flag { font-size:22px; line-height:1; display:inline-flex; align-items:center; }
    /* Twemoji è½‰å‡ºçš„ <img class="emoji"> çš„å°ºå¯¸å¾®èª¿ï¼Œè®“åœ‹æ——èˆ‡å­—é½Š */
    .country-flag img.emoji { height: 1.2em; width: auto; vertical-align: -0.15em; }

    .video-grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:16px; }
    .video-card { border-radius:16px; background:#0f2133; box-shadow:0 8px 24px rgba(0,0,0,.25); overflow:hidden; border:1px solid rgba(255,255,255,.06); }
    .video-thumb { aspect-ratio:16/9; width:100%; overflow:hidden; border-bottom:1px solid rgba(255,255,255,.06); background:var(--card-bg); }
    .video-thumb img { width:100%; height:100%; object-fit:cover; display:block; }
    .video-content { padding:14px 16px; }
    .video-title { font-weight:900; font-size:18px; margin:6px 0; line-height:1.35; color:#e9f3ff; }
    .video-desc { color:#93a6bf; font-size:14px; line-height:1.55; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    .video-tags { color:#8aa4c2; font-size:13px; margin-bottom:6px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .video-cta { margin-top:10px; padding:10px 14px; border-radius:12px; border:0; background:#3fa0ff; color:#001528; font-weight:800; cursor:pointer; }
    .placeholder { border:1px dashed #3a5b7b; border-radius:12px; padding:24px; color:#8aa4c2; text-align:center; }
    @media (max-width:640px){ .page-wrap{ padding:18px 4%; } .page-head h1{ font-size:24px; } }
  </style>
</head>
<body>
  <main class="page-wrap">
    <div class="page-head">
      <h1>æ‰€æœ‰ç¯€ç›®</h1>
      <span class="hint">è‡ªå‹•ä¾ã€Œæ´² â†’ åœ‹å®¶ï¼ç¶œåˆã€åˆ†çµ„ï¼ˆå¾æ¨™é¡Œâ†’æ¨™ç±¤â†’èªªæ˜æ–‡å­—åµæ¸¬åœ‹å®¶ï¼‰</span>
    </div>

    <div id="all-videos">
      <div class="placeholder">è¼‰å…¥ä¸­â€¦</div>
    </div>
  </main>

  <script>
  // ===== å°å·¥å…· =====
  const $ = (s, el=document) => el.querySelector(s);
  const escapeHtml = (s='') => String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');
  const norm = (str='') => String(str).trim().toLowerCase()
    .replace(/\s+/g,' ')
    .replace(/[()ï¼ãƒ»Â·â€šâ€™'Â´`â€™â€˜"]/g,'')
    .replace(/å°/g,'è‡º'); // çµ±ä¸€å°/è‡º

  // ===== æ´²æ¸…å–®ï¼ˆé¡¯ç¤ºé †åºï¼‰=====
  const CONTINENTS = [
    { key:'asia', label:'äºæ´²' },
    { key:'europe', label:'æ­æ´²' },
    { key:'north_america', label:'åŒ—ç¾æ´²' },
    { key:'south_america', label:'å—ç¾æ´²' },
    { key:'africa', label:'éæ´²' },
    { key:'oceania', label:'å¤§æ´‹æ´²' },
    { key:'antarctica', label:'å—æ¥µæ´²' },
    { key:'other', label:'å…¶ä»–' },
  ];

  // ===== å€åŸŸæç¤ºè©ï¼ˆç›´æŒ‡æ´²ï¼›æ‰¾ä¸åˆ°åœ‹å®¶æ™‚ä½¿ç”¨ï¼‰=====
  const REGION_HINTS = new Map([
    ['æ±äº','asia'],['æ±åŒ—äº','asia'],['æ±å—äº','asia'],['å—äº','asia'],['ä¸­äº','asia'],['è¥¿äº','asia'],['ä¸­æ±','asia'],
    ['æ­æ´²','europe'],['åŒ—æ­','europe'],['æ±æ­','europe'],['è¥¿æ­','europe'],['ä¸­æ­','europe'],['åœ°ä¸­æµ·','europe'],['å·´çˆ¾å¹¹','europe'],['æ–¯å ªåœ°é‚£ç¶­äº','europe'],
    ['åŒ—ç¾','north_america'],['å—ç¾','south_america'],['ä¸­å—ç¾','south_america'],
    ['éæ´²','africa'],['æ’’å“ˆæ‹‰','africa'],['æ’’å“ˆæ‹‰ä»¥å—éæ´²','africa'],
    ['å¤§æ´‹æ´²','oceania'],['å—å¤ªå¹³æ´‹','oceania'],
    ['å—æ¥µ','antarctica'],['å—æ¥µæ´²','antarctica'],
    ['east asia','asia'],['southeast asia','asia'],['south asia','asia'],['central asia','asia'],['middle east','asia'],
    ['europe','europe'],['mediterranean','europe'],['balkans','europe'],['scandinavia','europe'],['nordic','europe'],
    ['north america','north_america'],['south america','south_america'],['latin america','south_america'],
    ['africa','africa'],['sub-saharan','africa'],
    ['oceania','oceania'],['antarctica','antarctica'],
  ]);

  // ===== åœ‹å®¶åˆ¥åç´¢å¼•ï¼ˆæƒ³åŠ æ–°åœ‹å®¶å°±åŠ é€™è£¡ aliasesï¼‰=====
  const COUNTRY_INDEX = [
    { country:'æ—¥æœ¬', aliases:['æ—¥æœ¬','ã«ã»ã‚“','nihon','nippon','japan','jp'], continent:'asia' },
    { country:'éŸ“åœ‹', aliases:['éŸ“åœ‹','å—éŸ“','ëŒ€í•œë¯¼êµ­','korea','south korea','kr'], continent:'asia' },
    { country:'å°ç£', aliases:['è‡ºç£','å°ç£','taiwan','tw'], continent:'asia' },
    { country:'ä¸­åœ‹', aliases:['ä¸­åœ‹','ä¸­åœ‹å¤§é™¸','china','cn'], continent:'asia' },
    { country:'è’™å¤', aliases:['è’™å¤','mongolia','mn'], continent:'asia' },
    { country:'å“ˆè–©å…‹', aliases:['å“ˆè–©å…‹','å“ˆè–©å…‹æ–¯å¦','kazakhstan','kz'], continent:'asia' },
    { country:'å‰çˆ¾å‰æ–¯', aliases:['å‰çˆ¾å‰æ–¯','å‰çˆ¾å‰æ–¯æ–¯å¦','kyrgyzstan','kg','kirgiz'], continent:'asia' },
    { country:'çƒèŒ²åˆ¥å…‹', aliases:['çƒèŒ²åˆ¥å…‹','çƒèŒ²åˆ¥å…‹æ–¯å¦','uzbekistan','uz'], continent:'asia' },
    { country:'å¡”å‰å…‹', aliases:['å¡”å‰å…‹','å¡”å‰å…‹æ–¯å¦','tajikistan','tj'], continent:'asia' },
    { country:'åœŸåº«æ›¼', aliases:['åœŸåº«æ›¼','åœŸåº«æ›¼æ–¯å¦','turkmenistan','tm'], continent:'asia' },
    { country:'å°åº¦', aliases:['å°åº¦','india','in'], continent:'asia' },
    { country:'æ³°åœ‹', aliases:['æ³°åœ‹','thailand','th'], continent:'asia' },
    { country:'è¶Šå—', aliases:['è¶Šå—','vietnam','vn'], continent:'asia' },
    { country:'é¦¬ä¾†è¥¿äº', aliases:['é¦¬ä¾†è¥¿äº','malaysia','my'], continent:'asia' },
    { country:'å°å°¼', aliases:['å°å°¼','å°åº¦å°¼è¥¿äº','indonesia','id'], continent:'asia' },
    { country:'å°¼æ³Šçˆ¾', aliases:['å°¼æ³Šçˆ¾','nepal','np'], continent:'asia' },
    { country:'ä»¥è‰²åˆ—', aliases:['ä»¥è‰²åˆ—','israel','il'], continent:'asia' },
    { country:'ç´„æ—¦', aliases:['ç´„æ—¦','jordan','jo'], continent:'asia' },
    { country:'åœŸè€³å…¶', aliases:['åœŸè€³å…¶','turkiye','turkey','tr'], continent:'asia' },

    { country:'ä¿„ç¾…æ–¯', aliases:['ä¿„ç¾…æ–¯','russia','ru'], continent:'europe' }, /* åœ°è·¨ï¼Œå…ˆæ­¸æ­æ´² */
    { country:'èŠ¬è˜­', aliases:['èŠ¬è˜­','finland','fi'], continent:'europe' },
    { country:'æŒªå¨', aliases:['æŒªå¨','norway','no'], continent:'europe' },
    { country:'ç‘å…¸', aliases:['ç‘å…¸','sweden','se'], continent:'europe' },
    { country:'è‹±åœ‹', aliases:['è‹±åœ‹','uk','united kingdom','england','scotland','wales','northern ireland','gb'], continent:'europe' },
    { country:'æ³•åœ‹', aliases:['æ³•åœ‹','france','fr'], continent:'europe' },
    { country:'å¾·åœ‹', aliases:['å¾·åœ‹','germany','de'], continent:'europe' },
    { country:'ç¾©å¤§åˆ©', aliases:['ç¾©å¤§åˆ©','æ„å¤§åˆ©','italy','it'], continent:'europe' },
    { country:'è¥¿ç­ç‰™', aliases:['è¥¿ç­ç‰™','spain','es'], continent:'europe' },
    { country:'è‘¡è„ç‰™', aliases:['è‘¡è„ç‰™','portugal','pt'], continent:'europe' },
    { country:'æ·å…‹', aliases:['æ·å…‹','czech','czechia','cz'], continent:'europe' },
    { country:'å¥§åœ°åˆ©', aliases:['å¥§åœ°åˆ©','austria','at'], continent:'europe' },
    { country:'å†°å³¶', aliases:['å†°å³¶','iceland','is'], continent:'europe' },

    { country:'ç¾åœ‹', aliases:['ç¾åœ‹','usa','us','united states','america','u.s.'], continent:'north_america' },
    { country:'åŠ æ‹¿å¤§', aliases:['åŠ æ‹¿å¤§','canada','ca'], continent:'north_america' },
    { country:'å¢¨è¥¿å“¥', aliases:['å¢¨è¥¿å“¥','mexico','mx'], continent:'north_america' },

    { country:'å·´è¥¿', aliases:['å·´è¥¿','brazil','br'], continent:'south_america' },
    { country:'é˜¿æ ¹å»·', aliases:['é˜¿æ ¹å»·','argentina','ar'], continent:'south_america' },
    { country:'æ™ºåˆ©', aliases:['æ™ºåˆ©','chile','cl'], continent:'south_america' },
    { country:'ç¥•é­¯', aliases:['ç¥•é­¯','ç§˜é­¯','peru','pe'], continent:'south_america' },
    { country:'ç»åˆ©ç¶­äº', aliases:['ç»åˆ©ç¶­äº','bolivia','bo'], continent:'south_america' },
    { country:'å“¥å€«æ¯”äº', aliases:['å“¥å€«æ¯”äº','colombia','co'], continent:'south_america' },

    { country:'å—é', aliases:['å—é','south africa','za'], continent:'africa' },
    { country:'æ‘©æ´›å“¥', aliases:['æ‘©æ´›å“¥','morocco','ma'], continent:'africa' },
    { country:'åŸƒåŠ', aliases:['åŸƒåŠ','egypt','eg'], continent:'africa' },
    { country:'å¦å°šå°¼äº', aliases:['å¦å°šå°¼äº','å¦æ¡‘å°¼äº','tanzania','tz'], continent:'africa' },
    { country:'è‚¯äº', aliases:['è‚¯äº','kenya','ke'], continent:'africa' },

    { country:'æ¾³æ´²', aliases:['æ¾³æ´²','æ¾³å¤§åˆ©äº','australia','au'], continent:'oceania' },
    { country:'ç´è¥¿è˜­', aliases:['ç´è¥¿è˜­','æ–°è¥¿è˜­','new zealand','nz'], continent:'oceania' },
  ];

  // ===== åœ‹æ——ï¼ˆemojiï¼›Twemoji æœƒè½‰æˆ SVG åœ–ç‰‡ï¼‰=====
  const COUNTRY_FLAGS = {
    'æ—¥æœ¬':'ğŸ‡¯ğŸ‡µ','éŸ“åœ‹':'ğŸ‡°ğŸ‡·','å°ç£':'ğŸ‡¹ğŸ‡¼','ä¸­åœ‹':'ğŸ‡¨ğŸ‡³','è’™å¤':'ğŸ‡²ğŸ‡³','å“ˆè–©å…‹':'ğŸ‡°ğŸ‡¿','å‰çˆ¾å‰æ–¯':'ğŸ‡°ğŸ‡¬','çƒèŒ²åˆ¥å…‹':'ğŸ‡ºğŸ‡¿','å¡”å‰å…‹':'ğŸ‡¹ğŸ‡¯','åœŸåº«æ›¼':'ğŸ‡¹ğŸ‡²',
    'å°åº¦':'ğŸ‡®ğŸ‡³','æ³°åœ‹':'ğŸ‡¹ğŸ‡­','è¶Šå—':'ğŸ‡»ğŸ‡³','é¦¬ä¾†è¥¿äº':'ğŸ‡²ğŸ‡¾','å°å°¼':'ğŸ‡®ğŸ‡©','å°¼æ³Šçˆ¾':'ğŸ‡³ğŸ‡µ','ä»¥è‰²åˆ—':'ğŸ‡®ğŸ‡±','ç´„æ—¦':'ğŸ‡¯ğŸ‡´','åœŸè€³å…¶':'ğŸ‡¹ğŸ‡·',
    'ä¿„ç¾…æ–¯':'ğŸ‡·ğŸ‡º','èŠ¬è˜­':'ğŸ‡«ğŸ‡®','æŒªå¨':'ğŸ‡³ğŸ‡´','ç‘å…¸':'ğŸ‡¸ğŸ‡ª','è‹±åœ‹':'ğŸ‡¬ğŸ‡§','æ³•åœ‹':'ğŸ‡«ğŸ‡·','å¾·åœ‹':'ğŸ‡©ğŸ‡ª','ç¾©å¤§åˆ©':'ğŸ‡®ğŸ‡¹','è¥¿ç­ç‰™':'ğŸ‡ªğŸ‡¸','è‘¡è„ç‰™':'ğŸ‡µğŸ‡¹','æ·å…‹':'ğŸ‡¨ğŸ‡¿','å¥§åœ°åˆ©':'ğŸ‡¦ğŸ‡¹','å†°å³¶':'ğŸ‡®ğŸ‡¸',
    'ç¾åœ‹':'ğŸ‡ºğŸ‡¸','åŠ æ‹¿å¤§':'ğŸ‡¨ğŸ‡¦','å¢¨è¥¿å“¥':'ğŸ‡²ğŸ‡½',
    'å·´è¥¿':'ğŸ‡§ğŸ‡·','é˜¿æ ¹å»·':'ğŸ‡¦ğŸ‡·','æ™ºåˆ©':'ğŸ‡¨ğŸ‡±','ç¥•é­¯':'ğŸ‡µğŸ‡ª','ç»åˆ©ç¶­äº':'ğŸ‡§ğŸ‡´','å“¥å€«æ¯”äº':'ğŸ‡¨ğŸ‡´',
    'å—é':'ğŸ‡¿ğŸ‡¦','æ‘©æ´›å“¥':'ğŸ‡²ğŸ‡¦','åŸƒåŠ':'ğŸ‡ªğŸ‡¬','å¦å°šå°¼äº':'ğŸ‡¹ğŸ‡¿','è‚¯äº':'ğŸ‡°ğŸ‡ª',
    'æ¾³æ´²':'ğŸ‡¦ğŸ‡º','ç´è¥¿è˜­':'ğŸ‡³ğŸ‡¿'
  };
  const getFlag = (country) => COUNTRY_FLAGS[country] || '';

  // ===== æŸ¥è¡¨ï¼šç²¾ç¢ºï¼ˆtagsï¼‰èˆ‡æ–‡æœ¬ï¼ˆtitle/desc å­å­—ä¸²ï¼‰=====
  const ALIAS_EXACT = new Map();
  const ALIAS_TEXT = [];
  for (const row of COUNTRY_INDEX) {
    for (const a of row.aliases) {
      const key = norm(a);
      ALIAS_EXACT.set(key, { country: row.country, continent: row.continent });
      if (key.length > 2) ALIAS_TEXT.push({ alias: key, country: row.country, continent: row.continent });
    }
  }
  ALIAS_TEXT.sort((a,b) => b.alias.length - a.alias.length); // é•·åˆ¥åå„ªå…ˆ

  // ===== åˆ¤æ–·åœ‹å®¶ï¼æ´²ï¼ˆæ¨™é¡Œâ†’æ¨™ç±¤â†’èªªæ˜ï¼‰=====
  function guessCountryAndContinent({ title='', desc='', tags=[] }) {
    const nt = norm(title);
    const nd = norm(desc);
    const nTags = (Array.isArray(tags) ? tags : []).map(t => norm(String(t))).filter(Boolean);

    // 1) tags ç²¾ç¢ºåŒ¹é…ï¼ˆæœ€å¯é ï¼‰
    for (const t of nTags) {
      const hit = ALIAS_EXACT.get(t);
      if (hit) return hit;
    }
    // 2) æ¨™é¡Œå­å­—ä¸²
    for (const row of ALIAS_TEXT) if (nt.includes(row.alias)) return row;
    // 3) èªªæ˜å­å­—ä¸²
    for (const row of ALIAS_TEXT) if (nd.includes(row.alias)) return row;

    // 4) æ‰¾ä¸åˆ°åœ‹å®¶ â†’ ç”¨å€åŸŸè©åˆ¤æ–·æ´²ï¼ˆå…ˆçœ‹ tagsï¼Œå†çœ‹ title/descï¼‰
    for (const t of nTags) {
      const cont = REGION_HINTS.get(t);
      if (cont) return { country: null, continent: cont };
    }
    for (const [hint, cont] of REGION_HINTS.entries()) {
      const h = norm(hint);
      if (h.length > 2 && (nt.includes(h) || nd.includes(h))) {
        return { country: null, continent: cont };
      }
    }

    // 5) å…¨éƒ½æ²’æœ‰ â†’ å…¶ä»–
    return { country: null, continent: 'other' };
  }

  function classifyItem(v) {
    const { country, continent } = guessCountryAndContinent({
      title: v.title || '',
      desc:  v.desc  || '',
      tags:  v.tags  || []
    });

    const contKey   = continent || 'other';
    const contLabel = (CONTINENTS.find(c => c.key === contKey) || { label:'å…¶ä»–' }).label;
    let countryKey   = country ? norm(country) : 'mixed';
    let countryLabel = country || 'ç¶œåˆ';

    return { continentKey: contKey, continentLabel: contLabel, countryKey, countryLabel };
  }

  // ===== å–è³‡æ–™ä¸¦æ¸²æŸ“ =====
  (async function run(){
    const container = $('#all-videos');
    container.innerHTML = '<div class="placeholder">è¼‰å…¥ä¸­â€¦</div>';

    // é€£ Contentfulï¼ˆç”¨ä½ å‰å°åŒä¸€çµ„é‡‘é‘°ï¼‰
    const client = contentful.createClient({
      space: 'os5wf90ljenp',
      accessToken: 'lODH-WLwHwVZv7O4rFdBWjSnrzaQWGD4koeOZ1Dypj0'
    });

    let res;
    try {
      res = await client.getEntries({ content_type:'video', order:'-sys.updatedAt', limit:500 });
    } catch (e) {
      console.error(e);
      container.innerHTML = '<div class="placeholder">âŒ ç›®å‰ç„¡æ³•è¼‰å…¥æ‰€æœ‰ç¯€ç›®ã€‚</div>';
      return;
    }

    const pick = (obj, keys) => { for (const k of keys) if (obj && obj[k]!=null && obj[k]!=='') return obj[k]; return ''; };
    const items = res.items.map(it=>{
      const f = it.fields || {};
      const title = pick(f, ['å½±ç‰‡æ¨™é¡Œ','title']);
      const desc  = pick(f, ['ç²¾é¸æ¨è–¦å½±ç‰‡èªªæ˜æ–‡å­—','description']);
      const ytid  = pick(f, ['YouTube ID','youTubeId']);
      const mp4   = pick(f, ['MP4 å½±ç‰‡ç¶²å€','mp4Url']);
      const tags  = Array.isArray(f.tags) ? f.tags : [];
      let thumb   = f.thumbnail?.fields?.file?.url || '';
      if (thumb && !thumb.startsWith('http')) thumb = 'https:' + thumb;
      if (!thumb && ytid) thumb = `https://i.ytimg.com/vi/${ytid}/hqdefault.jpg`;
      return { title, desc, ytid, mp4, tags, thumb };
    });

    // åˆ†çµ„ï¼šgroups[continent].countries[countryKey].items[]
    const groups = {};
    for (const v of items) {
      const slot = classifyItem(v);
      groups[slot.continentKey] ??= { label: slot.continentLabel, countries:{} };
      groups[slot.continentKey].countries[slot.countryKey] ??= { label: slot.countryLabel, items: [] };
      groups[slot.continentKey].countries[slot.countryKey].items.push(v);
    }

    // æ¸²æŸ“
    container.innerHTML = '';

    // æ´²åˆ¥å¿«é€ŸéŒ¨é»
    const nav = document.createElement('div');
    nav.className = 'quick-nav';
    for (const c of CONTINENTS) {
      if (!groups[c.key]) continue;
      const a = document.createElement('a');
      a.href = `#cont-${c.key}`;
      a.textContent = c.label;
      nav.appendChild(a);
    }
    container.appendChild(nav);

    for (const c of CONTINENTS) {
      const node = groups[c.key];
      if (!node) continue;

      const contSection = document.createElement('section');
      contSection.id = `cont-${c.key}`;
      contSection.innerHTML = `<h2 class="continent-title">${node.label}</h2><div class="continent-body"></div>`;
      container.appendChild(contSection);
      const body = contSection.querySelector('.continent-body');

      const entries = Object.entries(node.countries).sort((a,b)=>{
        const A = a[1].label === 'ç¶œåˆ' ? '~~~' : a[1].label;
        const B = b[1].label === 'ç¶œåˆ' ? '~~~' : b[1].label;
        return String(A).localeCompare(String(B), 'zh-Hant');
      });

      for (const [ckey, bucket] of entries) {
        const flag = bucket.label === 'ç¶œåˆ' ? '' : getFlag(bucket.label);
        const block = document.createElement('div');
        block.id = `country-${c.key}-${ckey}`;
        block.innerHTML = `
          <h3 class="country-title">
            ${flag ? `<span class="country-flag">${flag}</span>` : ''}
            ${bucket.label}
          </h3>
          <div class="video-grid"></div>`;
        body.appendChild(block);

        const grid = block.querySelector('.video-grid');
        const frag = document.createDocumentFragment();

        bucket.items.forEach(v=>{
          const safeTitle = escapeHtml(v.title || 'æœªå‘½åå½±ç‰‡');
          const safeDesc  = v.desc ? escapeHtml(v.desc) : '';
          const ytFallback = v.ytid ? `https://i.ytimg.com/vi/${v.ytid}/hqdefault.jpg` : '';

          const card = document.createElement('div');
          card.className = 'video-card';
          card.innerHTML = `
            <div class="video-thumb">
              ${v.thumb ? `<img src="${v.thumb}" alt="${safeTitle}" loading="lazy" decoding="async"
                            onerror="this.onerror=null;this.src='${ytFallback}';">`
                        : `<div style="width:100%;height:100%;background:var(--card-bg);"></div>`}
            </div>
            <div class="video-content">
              ${Array.isArray(v.tags)&&v.tags.length ? `<div class="video-tags">${v.tags.map(t=>escapeHtml(String(t))).join(' / ')}</div>` : ``}
              <div class="video-title">${safeTitle}</div>
              ${safeDesc ? `<div class="video-desc">${safeDesc}</div>` : ``}
              ${
                v.ytid
                  ? `<button class="video-cta" data-videoid="${escapeHtml(v.ytid)}">ç«‹å³è§€çœ‹</button>`
                  : (v.mp4 ? `<a class="video-cta" href="${escapeHtml(v.mp4)}" target="_blank" rel="noopener">æ’­æ”¾ MP4</a>` : ``)
              }
            </div>`;
          frag.appendChild(card);
        });
        grid.appendChild(frag);
      }
    }

    // è§£æåœ‹æ—— emoji ç‚º SVGï¼ˆTwemojiï¼‰
    if (window.twemoji) {
      twemoji.parse(document.getElementById('all-videos'), {
        base: 'https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/',
        folder: 'svg',
        ext: '.svg'
      });
    }

    // æ’­æ”¾å™¨ï¼šè‹¥é¦–é æœ‰ openFullscreenPlayer() å°±æ²¿ç”¨ï¼›å¦å‰‡æ–°åˆ†é é–‹
    document.body.addEventListener('click', (e)=>{
      const btn = e.target?.closest?.('.video-cta');
      if (!btn) return;
      const id = btn.dataset.videoid;
      if (!id) return;
      if (typeof window.openFullscreenPlayer === 'function') {
        window.openFullscreenPlayer(id);
      } else {
        window.open(`https://www.youtube.com/watch?v=${encodeURIComponent(id)}`, '_blank', 'noopener');
      }
    });
  })();
  </script>
</body>
</html>
