<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¯€ç›®ç¯„æœ¬ç®¡ç† - èˆªå‘ä¸–ç•Œæ—…éŠé »é“</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; }
    
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    
    .header { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .header h1 { color: #2b71d2; margin-bottom: 10px; }
    
    .controls { background: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
    
    .btn { background: #2b71d2; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; margin-right: 10px; }
    .btn:hover { background: #1e5bb8; }
    .btn-secondary { background: #6c757d; }
    .btn-secondary:hover { background: #5a6268; }
    .btn-success { background: #28a745; }
    .btn-success:hover { background: #218838; }
    
    .templates-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px; }
    
    .template-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border: 2px solid transparent; transition: all 0.3s ease; }
    .template-card:hover { border-color: #2b71d2; transform: translateY(-2px); }
    
    .template-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .template-title { font-size: 1.2rem; font-weight: 600; color: #333; }
    .template-category { background: #e3f2fd; color: #1976d2; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; }
    
    .template-duration { color: #666; margin-bottom: 10px; }
    .template-description { color: #666; line-height: 1.5; margin-bottom: 15px; }
    
    .template-actions { display: flex; gap: 10px; }
    .template-actions .btn { margin: 0; padding: 8px 15px; font-size: 12px; }
    
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
    .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto; }
    .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .modal-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #666; }
    
    .form-group { margin-bottom: 15px; }
    .form-group label { display: block; margin-bottom: 5px; font-weight: 600; color: #333; }
    .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; }
    .form-group textarea { height: 80px; resize: vertical; }
    
    .status-bar { position: fixed; bottom: 20px; right: 20px; background: #333; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 1001; display: none; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“‹ ç¯€ç›®ç¯„æœ¬ç®¡ç†</h1>
      <p>ç®¡ç†ç¯€ç›®ç¯„æœ¬åº«ï¼Œå»ºç«‹æ¨™æº–åŒ–ç¯€ç›®æ ¼å¼</p>
    </div>
    
    <div class="controls">
      <div>
        <button class="btn btn-success" onclick="openTemplateModal()">â• æ–°å¢ç¯„æœ¬</button>
        <button class="btn btn-secondary" onclick="window.location.href='admin-dashboard.html'">ğŸ  è¿”å›ä¸»æ§å°</button>
      </div>
      <div>
        <span id="templateCount">ç¸½è¨ˆ 0 å€‹ç¯„æœ¬</span>
      </div>
    </div>
    
    <div class="templates-grid" id="templatesGrid">
      <!-- ç¯„æœ¬å¡ç‰‡å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
    </div>
  </div>
  
  <!-- ç¯„æœ¬ç·¨è¼¯æ¨¡æ…‹æ¡† -->
  <div class="modal" id="templateModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">æ–°å¢ç¯„æœ¬</h3>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      
      <form id="templateForm">
        <input type="hidden" id="editId">
        
        <div class="form-group">
          <label>ç¯„æœ¬åç¨±ï¼š</label>
          <input type="text" id="title" placeholder="ä¾‹å¦‚ï¼šæ—©å®‰ä¸–ç•Œ" required>
        </div>
        
        <div class="form-group">
          <label>ç¯€ç›®åˆ†é¡ï¼š</label>
          <select id="category" required>
            <option value="">-- é¸æ“‡åˆ†é¡ --</option>
            <option value="äºæ´²æ—…éŠ">äºæ´²æ—…éŠ</option>
            <option value="æ­æ´²æ—…éŠ">æ­æ´²æ—…éŠ</option>
            <option value="ç¾æ´²æ—…éŠ">ç¾æ´²æ—…éŠ</option>
            <option value="ç¾é£Ÿæ—…éŠ">ç¾é£Ÿæ—…éŠ</option>
            <option value="æ¥µåœ°æ—…éŠ">æ¥µåœ°æ—…éŠ</option>
            <option value="è‡ªç„¶æ—…éŠ">è‡ªç„¶æ—…éŠ</option>
            <option value="æ–‡åŒ–æ—…éŠ">æ–‡åŒ–æ—…éŠ</option>
            <option value="å†’éšªæ—…éŠ">å†’éšªæ—…éŠ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ç¯€ç›®æ™‚é•·ï¼š</label>
          <select id="duration" required>
            <option value="30">30åˆ†é˜</option>
            <option value="60">60åˆ†é˜</option>
            <option value="90">90åˆ†é˜</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>ç¯„æœ¬æè¿°ï¼š</label>
          <textarea id="description" placeholder="æè¿°é€™å€‹ç¯„æœ¬çš„ç‰¹é»å’Œç”¨é€”..."></textarea>
        </div>
        
        <div class="form-group">
          <label>é è¨­ç‹€æ…‹ï¼š</label>
          <select id="status" required>
            <option value="é‡æ’­">é‡æ’­</option>
            <option value="é¦–æ’­">é¦–æ’­</option>
            <option value="ç‰¹åˆ¥ç¯€ç›®">ç‰¹åˆ¥ç¯€ç›®</option>
          </select>
        </div>
        
        <button type="submit" class="btn btn-success">ğŸ’¾ å„²å­˜ç¯„æœ¬</button>
        <button type="button" class="btn btn-secondary" onclick="closeModal()">âŒ å–æ¶ˆ</button>
      </form>
    </div>
  </div>
  
  <div class="status-bar" id="statusBar">
    <span id="statusMessage"></span>
  </div>

  <script>
    let templates = [];
    let editingId = null;
    
    document.addEventListener('DOMContentLoaded', function() {
      loadTemplates();
      renderTemplates();
    });
    
    function loadTemplates() {
      const saved = localStorage.getItem('program_templates');
      if (saved) {
        templates = JSON.parse(saved);
      } else {
        // é è¨­ç¯„æœ¬
        templates = [
          {
            id: '1',
            title: 'æ—©å®‰ä¸–ç•Œ',
            category: 'äºæ´²æ—…éŠ',
            duration: 60,
            description: 'è·Ÿè‘—æˆ‘å€‘ä¸€èµ·æ¢ç´¢å„åœ°çš„æ—©æ™¨ï¼Œå¾ç•¶åœ°å¸‚å ´åˆ°è‘—åæ™¯é»çš„å¯§éœæ™‚å…‰',
            status: 'é¦–æ’­'
          },
          {
            id: '2',
            title: 'ä¸–ç•Œå»šæˆ¿',
            category: 'ç¾é£Ÿæ—…éŠ',
            duration: 45,
            description: 'æ·±å…¥å„åœ°ï¼Œå“åšæœ€é“åœ°çš„ç•¶åœ°ç¾é£Ÿèˆ‡ç‰¹è‰²æ–™ç†',
            status: 'é‡æ’­'
          },
          {
            id: '3',
            title: 'æ¥µåœ°æ¢éšª',
            category: 'æ¥µåœ°æ—…éŠ',
            duration: 60,
            description: 'è¿½å°‹æ¥µå…‰çš„ç¥ç§˜è¹¤è·¡ï¼Œé«”é©—æ¥µåœ°æ¢éšªçš„åˆºæ¿€',
            status: 'ç‰¹åˆ¥ç¯€ç›®'
          }
        ];
        saveTemplates();
      }
    }
    
    function saveTemplates() {
      localStorage.setItem('program_templates', JSON.stringify(templates));
    }
    
    function renderTemplates() {
      const grid = document.getElementById('templatesGrid');
      const count = document.getElementById('templateCount');
      
      grid.innerHTML = templates.map(template => `
        <div class="template-card">
          <div class="template-header">
            <div class="template-title">${template.title}</div>
            <div class="template-category">${template.category}</div>
          </div>
          <div class="template-duration">â±ï¸ ${template.duration}åˆ†é˜</div>
          <div class="template-description">${template.description}</div>
          <div class="template-actions">
            <button class="btn btn-secondary" onclick="editTemplate('${template.id}')">âœï¸ ç·¨è¼¯</button>
            <button class="btn" onclick="useTemplate('${template.id}')">ğŸ“… ä½¿ç”¨ç¯„æœ¬</button>
            <button class="btn btn-secondary" onclick="deleteTemplate('${template.id}')">ğŸ—‘ï¸ åˆªé™¤</button>
          </div>
        </div>
      `).join('');
      
      count.textContent = `ç¸½è¨ˆ ${templates.length} å€‹ç¯„æœ¬`;
    }
    
    function openTemplateModal() {
      editingId = null;
      document.getElementById('modalTitle').textContent = 'æ–°å¢ç¯„æœ¬';
      document.getElementById('templateForm').reset();
      document.getElementById('templateModal').style.display = 'block';
    }
    
    function closeModal() {
      document.getElementById('templateModal').style.display = 'none';
    }
    
    function editTemplate(id) {
      const template = templates.find(t => t.id === id);
      if (template) {
        editingId = id;
        document.getElementById('modalTitle').textContent = 'ç·¨è¼¯ç¯„æœ¬';
        document.getElementById('editId').value = id;
        document.getElementById('title').value = template.title;
        document.getElementById('category').value = template.category;
        document.getElementById('duration').value = template.duration;
        document.getElementById('description').value = template.description;
        document.getElementById('status').value = template.status;
        document.getElementById('templateModal').style.display = 'block';
      }
    }
    
    function deleteTemplate(id) {
      if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹ç¯„æœ¬å—ï¼Ÿ')) {
        templates = templates.filter(t => t.id !== id);
        saveTemplates();
        renderTemplates();
        showStatus('ç¯„æœ¬å·²åˆªé™¤', 'success');
      }
    }
    
    function useTemplate(id) {
      const template = templates.find(t => t.id === id);
      if (template) {
        // å°‡ç¯„æœ¬è³‡æ–™å‚³éåˆ°çµ±ä¸€ç®¡ç†ç³»çµ±
        localStorage.setItem('selected_template', JSON.stringify(template));
        window.location.href = 'admin-calendar-unified.html';
      }
    }
    
    document.getElementById('templateForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const template = {
        id: editingId || Date.now().toString(),
        title: document.getElementById('title').value,
        category: document.getElementById('category').value,
        duration: parseInt(document.getElementById('duration').value),
        description: document.getElementById('description').value,
        status: document.getElementById('status').value
      };
      
      if (editingId) {
        // ç·¨è¼¯ç¾æœ‰ç¯„æœ¬
        const index = templates.findIndex(t => t.id === editingId);
        if (index !== -1) {
          templates[index] = template;
        }
      } else {
        // æ–°å¢ç¯„æœ¬
        templates.push(template);
      }
      
      saveTemplates();
      renderTemplates();
      closeModal();
      showStatus(editingId ? 'ç¯„æœ¬å·²æ›´æ–°' : 'ç¯„æœ¬å·²æ–°å¢', 'success');
    });
    
    function showStatus(message, type) {
      const statusBar = document.getElementById('statusBar');
      const statusMessage = document.getElementById('statusMessage');
      
      statusMessage.textContent = message;
      statusBar.style.display = 'block';
      
      statusBar.style.backgroundColor = type === 'success' ? '#4caf50' : 
                                      type === 'error' ? '#f44336' : 
                                      type === 'warning' ? '#ff9800' : '#333';
      
      setTimeout(() => {
        statusBar.style.display = 'none';
      }, 3000);
    }
    
    window.addEventListener('click', function(e) {
      const modal = document.getElementById('templateModal');
      if (e.target === modal) {
        closeModal();
      }
    });
  </script>
</body>
</html>
