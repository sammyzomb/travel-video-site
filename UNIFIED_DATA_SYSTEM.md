# 🔄 統一資料管理系統說明

## 📋 系統概述

您的旅遊電視台後台系統現在已經實現了**四個子系統的完整資料串接**，所有節目資料都會在以下系統之間同步：

### 🎯 四個子系統
1. **📅 月曆節目管理** - 視覺化月曆介面
2. **📋 節目表管理** - 列表式節目管理
3. **📦 歸檔管理** - 已播出節目歸檔
4. **🏠 主控台** - 統一導航入口

## 🔄 資料串接機制

### 📊 統一資料儲存
```javascript
// 所有系統使用相同的 localStorage 鍵值
const DATA_KEYS = {
  PROGRAMS: 'tv_programs_data',    // 節目資料
  ARCHIVES: 'tv_archives_data',    // 歸檔資料
  TEMPLATES: 'tv_templates_data'   // 範本資料
};
```

### 🔄 即時同步機制
1. **事件驅動同步**：當任一系統修改資料時，會觸發自定義事件
2. **自動更新**：其他系統會自動接收更新通知並刷新顯示
3. **資料一致性**：確保所有系統顯示相同的節目資料

## 📈 資料流程圖

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   月曆節目管理   │    │   節目表管理     │    │    歸檔管理     │
│                 │    │                 │    │                 │
│ 📅 視覺化介面   │    │ 📋 列表式介面   │    │ 📦 歸檔介面     │
│ ✏️ 新增/編輯    │    │ ✏️ 新增/編輯    │    │ 🗂️ 歸檔/還原    │
│ 🗑️ 刪除節目    │    │ 🗑️ 刪除節目    │    │ 🗑️ 永久刪除     │
└─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘
          │                      │                      │
          └──────────┬───────────┴──────────┬───────────┘
                     │                      │
              ┌──────▼──────┐      ┌──────▼──────┐
              │ localStorage │      │ 自定義事件   │
              │             │      │             │
              │ 統一資料儲存 │      │ 即時同步通知 │
              └─────────────┘      └─────────────┘
```

## 🎯 各系統功能對應

### 📅 月曆節目管理
- **新增節目**：點擊空白時段 → 填寫資訊 → 自動同步到其他系統
- **編輯節目**：點擊節目 → 修改資訊 → 自動同步到其他系統
- **刪除節目**：點擊節目 → 確認刪除 → 自動同步到其他系統

### 📋 節目表管理
- **查看所有節目**：顯示所有節目的列表視圖
- **編輯節目**：點擊編輯按鈕 → 修改資訊 → 自動同步到其他系統
- **刪除節目**：點擊刪除按鈕 → 確認刪除 → 自動同步到其他系統

### 📦 歸檔管理
- **統計資訊**：顯示總節目數、歸檔數、已播出數、未播出數
- **歸檔節目**：將已播出的節目移到歸檔
- **還原節目**：將歸檔節目還原到節目列表
- **永久刪除**：徹底刪除歸檔節目

## 🔧 技術實現細節

### 1. 資料儲存
```javascript
// 儲存節目資料
localStorage.setItem('tv_programs_data', JSON.stringify(programs));

// 載入節目資料
const programs = JSON.parse(localStorage.getItem('tv_programs_data') || '[]');
```

### 2. 事件同步
```javascript
// 觸發資料更新事件
const event = new CustomEvent('programsDataUpdated', {
  detail: { programs: allPrograms }
});
window.dispatchEvent(event);

// 監聽資料更新事件
window.addEventListener('programsDataUpdated', function(event) {
  console.log('收到資料更新通知');
  loadAllPrograms(); // 重新載入資料
});
```

### 3. 資料結構
```javascript
// 節目資料結構
{
  airDate: "2025-01-15",        // 播出日期
  airTime: "14:00",            // 播出時間
  title: "節目標題",           // 節目名稱
  duration: 60,                // 節目時長（分鐘）
  category: "亞洲旅遊",        // 節目分類
  description: "節目描述",     // 節目描述
  youtubeId: "影片ID",         // YouTube影片ID
  status: "首播",              // 節目狀態
  createdBy: "admin@example.com", // 建立者
  createdAt: "2025-01-15T10:00:00Z" // 建立時間
}
```

## 🧪 測試方法

### 1. 基本功能測試
1. **登入後台**：`admin-login.html`
2. **進入主控台**：`admin-dashboard.html`
3. **測試月曆管理**：
   - 新增一個節目
   - 檢查節目表管理是否顯示相同節目
   - 檢查歸檔管理的統計是否更新

### 2. 同步功能測試
1. **在月曆中新增節目**
2. **切換到節目表管理**：應該看到相同節目
3. **切換到歸檔管理**：統計數字應該更新
4. **在節目表管理中編輯節目**
5. **回到月曆管理**：應該看到更新後的節目

### 3. 歸檔功能測試
1. **在歸檔管理中歸檔一個節目**
2. **檢查月曆和節目表**：該節目應該消失
3. **在歸檔中還原節目**
4. **檢查月曆和節目表**：該節目應該重新出現

## 🚨 注意事項

### 資料安全
- 所有資料儲存在瀏覽器的 localStorage 中
- 清除瀏覽器資料會導致節目資料遺失
- 建議定期備份重要資料

### 瀏覽器相容性
- 支援所有現代瀏覽器
- 需要啟用 JavaScript
- 需要啟用 localStorage 功能

### 效能考量
- 大量節目資料可能影響載入速度
- 建議定期清理過期資料
- 可以考慮分頁顯示大量資料

## 🔮 未來擴展

### 短期目標
- [ ] 添加資料匯入/匯出功能
- [ ] 實現節目範本系統
- [ ] 添加搜尋和篩選功能

### 長期目標
- [ ] 整合 Contentful CMS
- [ ] 實現多用戶權限管理
- [ ] 添加節目統計分析
- [ ] 實現自動備份功能

---

**最後更新**：2025年1月15日  
**版本**：v1.0  
**狀態**：功能完整，可正常使用
